paths:
  /login:
    post:
      summary: Iniciar sesión de usuario
      operationId: login
      requestBody:
        description: Credenciales del usuario
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginCredentials"
      responses:
        "200":
          description: Login exitoso
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: JWT token para autenticación
        "400":
          description: Solicitud incorrecta
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Bad Request"
        "401":
          description: Credenciales inválidas
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid email or password"
        "500":
          description: Error interno del servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal Server Error"

  /register:
    post:
      summary: Registrar un nuevo usuario
      operationId: registerUser
      requestBody:
        description: Datos del usuario a registrar
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NewUser"
      responses:
        "201":
          description: Usuario registrado exitosamente
        "400":
          description: Solicitud incorrecta
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Bad Request"
        "500":
          description: Error interno del servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal Server Error"

  /me:
    get:
      summary: Obtener datos del usuario autenticado
      operationId: getProfile
      responses:
        "200":
          description: Datos del usuario
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserProfile"
        "401":
          description: No autorizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Unauthorized"
        "500":
          description: Error interno del servidor
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Internal Server Error"

components:
  schemas:
    NewUser:
      type: object
      properties:
        username:
          type: string
        email:
          type: string
          format: email
        password:
          type: string
        birthdate:
          type: string
          format: date
        profilePictureUrl:
          type: string
          format: uri
        gender:
          type: string
          enum:
            - male
            - female
      required:
        - username
        - password
        - email

    LoginCredentials:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email del usuario
        password:
          type: string
          description: Contraseña del usuario
        firebaseToken:
          type: string
          description: Token de Firebase para notificaciones push
        platform:
          type: string
          description: Plataforma del dispositivo (android, ios, web)
          enum:
            - android
            - ios
            - web
        deviceId:
          type: string
          description: ID único del dispositivo (para distinguir múltiples devices por plataforma)
      required:
        - email
        - password
        - firebaseToken
        - platform
        - deviceId

    UserProfile:
      type: object
      properties:
        id:
          type: number
          description: ID del usuario
        name:
          type: string
          description: Nombre del usuario
        email:
          type: string
          format: email
          description: Email del usuario
        birthdate:
          type: string
          format: date
          description: Fecha de nacimiento del usuario
        profilePictureUrl:
          type: string
          format: uri
          description: URL de la foto de perfil
        gender:
          type: string
          enum:
            - male
            - female
      required:
        - id
        - name
        - email
